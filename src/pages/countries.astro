---
import Layout from '../layouts/Layout.astro';
import { countries } from '../data/countries.json';

const eventStyles = {
  foundation: 'bg-green-100 text-green-800 border-green-200',
  development: 'bg-blue-100 text-blue-800 border-blue-200',
  conflict: 'bg-red-100 text-red-800 border-red-200',
  diplomacy: 'bg-red-100 text-yello-800 border-yello-200',
  default: 'bg-gray-100 text-gray-800 border-gray-200'
};

const eventIcons = {
  foundation: 'ğŸ›ï¸',
  development: 'ğŸ—ï¸',
  conflict: 'âš”ï¸',
  diplomacy: 'ğŸ¤',
  default: 'ğŸ“œ'
};

// ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ç”¨ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
let searchQuery = '';
const filteredCountries = () =>
  countries.filter((country) =>
    country.name.toLowerCase().includes(searchQuery.toLowerCase())
  );
---
<Layout title="å›½å®¶ä¸€è¦§ - ã‹ã‚Earth Wiki">
	<head>
  		<title>ã€å…¬å¼ã€‘ã‹ã‚Earth Wiki</title>
  		<meta name="description" content="ã‹ã‚Earthã®å…¬å¼Wikiã§ã™ã€‚æ§˜ã€…ãªæƒ…å ±ãŒè¼‰ã£ã¦ã„ã¾ã™" />
  		<meta name="robots" content="index, follow" /> <!-- ã‚¯ãƒ­ãƒ¼ãƒ©ãƒ¼ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’è¨±å¯ -->
  		<meta property="og:title" content="ã€å…¬å¼ã€‘ã‹ã‚Earth Wiki" />
  		<meta property="og:description" content="ã‹ã‚Earthã®å…¬å¼Wikiã§ã™ã€‚æ§˜ã€…ãªæƒ…å ±ãŒè¼‰ã£ã¦ã„ã¾ã™" />
  		<meta property="og:type" content="website" />
  		<meta property="og:url" content="https://wiki.karoearth.xyz" />
  	  <meta property="og:image" content="https://wiki.karoearth.xyz/src/images/title.png" />
	</head>

<body>
    <div class="flex flex-col lg:flex-row lg:items-start lg:gap-0">
      <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
      <aside
        class="w-full lg:w-64 bg-gray-100 p-6 h-auto border-b lg:border-b-0 border-gray-200"
      >
        <h2 class="text-xl font-bold mb-4">å›½å®¶ä¸€è¦§</h2>
        <input
          type="text"
          placeholder="æ¤œç´¢"
          class="w-full p-2 mb-4 rounded border border-gray-300"
          onInput={(e) => (searchQuery = e.target.value)}
        />
        <ul class="space-y-2">
          {filteredCountries().map((country) => (
            <li>
              <a
                href={`#${country.name}`}
                class="block p-2 rounded hover:bg-gray-200"
              >
                {country.name}
              </a>
            </li>
          ))}
        </ul>
      </aside>

      <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
      <main class="flex-1 p-0 main">
        <div>
          <h1 class="text-4xl font-bold mb-8 text-center">å›½å®¶ä¸€è¦§</h1>

          <div class="space-y-12">
            {filteredCountries().map((country) => (
<section
              id={country.name}
              class="bg-white p-4 rounded-lg shadow-lg"
            >
              <div class="border-b-2 border-gray-200 pb-6 mb-6">
                <h2 class="text-3xl font-bold mb-4">{country.name}</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div class="space-y-3">
                    <div>
                      <span class="font-semibold">å»ºå›½æ—¥ï¼š</span>
                      <span class="font-serif">{country.foundedDate}</span>
                    </div>
                    <div>
                      <span class="font-semibold">çµ±æ²»å½¢æ…‹ï¼š</span>
                      <span>{country.governmentType}</span>
                    </div>
                    <div>
                      <span class="font-semibold">èª¬æ˜ï¼š</span>
                      <p class="mt-2 pl-2">
                        {country.features.split("\n").map((line, index) => (
                          <>
                            {line}
                            {index < country.features.split("\n").length - 1 && <br />}
                          </>
                        ))}
                      </p>
                    </div>
                  </div>
                  <div class="space-y-3">
                    <div>
                      <span class="font-semibold">åº§æ¨™ï¼š</span>
                      <div class="font-mono bg-gray-100 p-2 rounded mt-1">
                        X: {country.coordinates.x}
                        Y: {country.coordinates.y}
                        Z: {country.coordinates.z}
                      </div>
                    </div>
                    <div>
                      <span class="font-semibold">å ´æ‰€ï¼š</span>
                      <p class="mt-1">{country.location}</p>
                    </div>
                    {
                      country?.flag && <img src={`src/images/country/${country.flag}`} alt="Country Flag" />
                    }
                  </div>
                </div>
              </div>

              <!-- å›½å®¶ã®æ­´å² -->
              <div class="mb-8">
                <h3 class="text-2xl font-bold mb-6 text-center">å›½å®¶ã®æ­´å²</h3>
                <div class="max-w-4xl mx-auto">
                  <div class="relative pl-8">
                    <div class="absolute left-0 top-0 bottom-0 w-0.5 bg-gray-200"></div>

                    {country.history.map((event, index) => (
                      <div class="relative mb-8">
                        <div class="absolute -left-2.5 top-5 w-5 h-5 rounded-full bg-white border-4 border-gray-300"></div>
                        <div
                          class={`ml-8 p-6 rounded-lg border-2 ${
                            eventStyles[event.type] || eventStyles.default
                          }`}
                        >
                          <div class="flex items-center gap-3 mb-2">
                            <span
                              class="text-2xl"
                              role="img"
                              aria-label={event.type}
                            >
                              {eventIcons[event.type] || eventIcons.default}
                            </span>
                            <div>
                              <h4 class="text-xl font-bold">{event.title}</h4>
                              <p class="text-sm font-serif">{event.date}</p>
                            </div>
                          </div>
                          <p class="mt-2 pl-10">
                            {event.description.split("\n").map((line, index) => (
                              <>
                                {line}
                                {index < event.description.split("\n").length - 1 && <br />}
                              </>
                            ))}
                          </p>
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              </div>

              <!-- ãƒ©ãƒ³ãƒ‰ãƒãƒ¼ã‚¯ -->
              <div>
                <h3 class="text-2xl font-bold mb-6 text-center">ä¸»è¦å»ºé€ ç‰©</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                  {country.landmarks.map((landmark) => (
                    <div class="bg-gray-50 p-6 rounded-lg border-2 border-gray-100">
                      <div class="flex items-center gap-3 mb-2">
                        <span class="text-2xl">ğŸ›ï¸</span>
                        <h4 class="text-xl font-bold">{landmark.name}</h4>
                      </div>

                      <div class="pl-10">
                        <p class="text-gray-600">{landmark.description}</p>
                        <span class="text-gray-600">åº§æ¨™ï¼š</span>
                        <p class="font-mono bg-gray-100 p-2 rounded mt-1">
                            X: {landmark.coordinates.x}
                            Y: {landmark.coordinates.y}
                            Z: {landmark.coordinates.z}
                        </p>
						            </span>
                        <p class="text-sm text-gray-500 mt-2">
                          å®Œæˆæ—¥: <span class="font-serif">{landmark.completionDate}</span>
                        </p>
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            </section>
            ))}
          </div>
        </div>
      </main>
    </div>
  </body>
</Layout>

<style>
  html {
    font-family: system-ui, sans-serif;
    background: #f6f6f6;
    font-size: 25px;
  }

  main {
    margin-top: 5%;
    margin-bottom: 5%;
    transform: scale(1);

  }
  aside {
    margin-top: 5%;
    margin-bottom: 5%;
    transform: scale(1);
  }

  @media (max-width: 1024px) {
    /* ã‚¹ãƒãƒ›ãƒ»ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆè¡¨ç¤ºã®è¨­å®š */
    .flex {
      flex-direction: column; /* ç¸¦ä¸¦ã³ã«ã™ã‚‹ */
    }

    aside {
      width: 90%; /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚’å…¨å¹…ã« */
    }

    main {
      padding-top: 0;
    }
      main {
    margin-top: 20%;
    margin-bottom: 25%;
    transform: scale(1.2);

  }
  aside {
    margin-top: 20%;
    margin-bottom: 20%;
    transform: scale(1.3);
  }
  }

  @media (min-width: 1025px) {
    /* ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—è¡¨ç¤ºã®è¨­å®š */
    .flex {
      flex-direction: row; /* æ¨ªä¸¦ã³ã«æˆ»ã™ */
    }

    aside {
      width: 16rem; /* ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã§ã¯å›ºå®šå¹… */
    }
  }
    @media (max-width: 768px) {
    /* ã‚¹ãƒãƒ›è¡¨ç¤ºã®è¨­å®š */
    section {
      width: 90%; /* å„å›½å®¶ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®å¹…ã‚’90%ã«èª¿æ•´ */
      margin: 0 auto; /* ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä¸­å¤®æƒãˆ */
    }

    aside {
      padding: 1rem; /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®ä½™ç™½ã‚’èª¿æ•´ */
    }

    main {
      padding: 1rem; /* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ä½™ç™½ã‚’èª¿æ•´ */
    }
  }
  .flex {
    flex-grow: 1;
  }
</style>